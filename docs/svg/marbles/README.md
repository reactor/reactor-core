## Prerequisites

1. Install [IBM Plex Sans](https://fonts.google.com/specimen/IBM+Plex+Sans) & [Fira Code](https://github.com/tonsky/FiraCode) font on your local machine
2. Install [Inkscape](https://inkscape.org)
3. Make sure you installed [svgo](https://github.com/svg/svgo)
  1. Install [yarn](https://yarnpkg.com)
  2. Install `svgo` by running `yarn global add svgo` from terminal

## SVG create/update workflow

> NOTE: No files inside `../../../reactor-core/src/main/java/reactor/core/publisher/doc-files/marbles` folder should be edited manually, as this folder should be regenerated by running `optimize.sh` shell script

1. Update marbles in `raw` folder. These are inkscape unoptimized svg files \[Dont touch any file anything inside `../../../reactor-core/src/main/java/reactor/core/publisher/doc-files/marbles` folder\]
2. Optimize svg files inside `../../../reactor-core/src/main/java/reactor/core/publisher/doc-files/marbles` folder by following below steps

## Optimize SVGs

1. Run `./optimize.sh` from terminal
2. You should see the optimized svgs in `../../../reactor-core/src/main/java/reactor/core/publisher/doc-files/marbles` sub directory


## Optimizing just a single svg (useful during development)

After editing a single raw svg file, you can regenerate an optimized version for this single svg by running a command of this format

```sh
SVG_FILE_NAME=<file name>; rm /tmp/$SVG_FILE_NAME 2> /dev/null || true && inkscape --export-text-to-path --export-plain-svg=/tmp/$SVG_FILE_NAME raw/$SVG_FILE_NAME --without-gui && svgo --multipass --disable={cleanupIDs,removeNonInheritableGroupAttrs} -i /tmp/$SVG_FILE_NAME -o ../../../reactor-core/src/main/java/reactor/core/publisher/doc-files/marbles/$SVG_FILE_NAME
```

For example to get an optimized version of `raw/transformForFlux.svg` run the following command
```sh
SVG_FILE_NAME=transformForFlux.svg; rm /tmp/$SVG_FILE_NAME 2> /dev/null || true && inkscape --export-text-to-path --export-plain-svg=/tmp/$SVG_FILE_NAME raw/$SVG_FILE_NAME --without-gui && svgo --multipass --disable={cleanupIDs,removeNonInheritableGroupAttrs} -i /tmp/$SVG_FILE_NAME -o ../../../reactor-core/src/main/java/reactor/core/publisher/doc-files/marbles/$SVG_FILE_NAME
```

After this command is run, you should see the optimized version in `../../../reactor-core/src/main/java/reactor/core/publisher/doc-files/marbles/transformForFlux.svg`
